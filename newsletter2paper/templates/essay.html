<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ issue_info.title or 'Newsletter Collection' }}</title>
    <style>
        {
                {
                css_content|safe
            }
        }
    </style>
</head>

<body>
    {# Collection Header #}
    <div class="collection-header">
        <h1>{{ issue_info.title or 'Newsletter Collection' }}</h1>
        <div class="collection-date">{{ current_date }}</div>
        <div class="collection-summary">{{ articles|length }} articles compiled</div>
    </div>

    {# Table of Contents - only show if multiple articles #}
    {% if articles|length > 1 %}
    <div class="toc">
        <h2>Table of Contents</h2>
        <ul>
            {% for article in articles %}
            <li>
                {{ loop.index }}. <a href="#article-{{ loop.index }}">{{ article.title or 'Article ' ~ loop.index }}</a>
                {% if article.author %}
                <span class="toc-author">by {{ article.author }}</span>
                {% endif %}
                {% if article.publication_name or article.feed_title %}
                <span class="toc-publication">({{ article.publication_name or article.feed_title }})</span>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {# Articles #}
    {% for article in articles %}
    <div class="article" id="article-{{ loop.index }}">
        {# Article Header #}
        <div class="article-header">
            <div class="article-title">{{ article.title or 'Article ' ~ loop.index }}</div>

            {% if article.author %}
            <div class="article-meta">Author: {{ article.author }}</div>
            {% endif %}

            {% if article.pub_date or article.published_date %}
            <div class="article-meta">Published: {{ article.pub_date or article.published_date }}</div>
            {% endif %}

            {% if article.publication_name or article.feed_title %}
            <div class="article-meta">Source: {{ article.publication_name or article.feed_title }}</div>
            {% endif %}

            {% if article.url or article.link %}
            <div class="article-meta">URL: <a href="{{ article.url or article.link }}">{{ article.url or article.link
                    }}</a></div>
            {% endif %}
        </div>

        {# Article Content #}
        <div class="article-content">
            {{ article.content|safe }}
        </div>
    </div>
    {% endfor %}

</body>

</html>